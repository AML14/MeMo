# Toradocu
Toradocu - automated generation of test oracles from Javadoc documentation

Toradocu generates test oracles from the Javadoc documentation of a
class. Toradocu is described in the paper *Automatic Generation of
Oracles for Exceptional Behaviors* by Alberto Goffi, Alessandra
Gorla, Michael D. Ernst, and Mauro Pezzè (presented at
[ISSTA 2016](https://issta2016.cispa.saarland)).

Toradocu takes the source code of a class as input and produces a set of
[aspects](https://eclipse.org/aspectj/).


## Building Toradocu
To compile Toradocu run the command: `./gradlew shadowJar`

This will create the file 
`build/libs/toradocu-0.1-all.jar`.

Notice that building Toradocu requires Java JDK 1.8+. 


## Running Toradocu
Toradocu is a command-line tool.
A typical Toradocu invocation looks like this:

    java -jar toradocu-0.1-all.jar \
       --targetClass mypackage.MyClass \
       --outputDir output \
       --testClass mypackage.Test \
       -J-d=output/javadoc \
       -J-sourcepath=project/src

With those options, Toradocu generates [AspectJ aspects](https://eclipse.org/aspectj/)
in the folder `output`. `output-javadoc` contains the output of the `javadoc`
tool. Aspects generated by Toradocu are standard AspectJ aspects and can
be used to instrument an existing test suite. Please refer to the
[AspectJ documentation](https://eclipse.org/aspectj/doc/released/devguide/ajc-ref.html)
for more information.

To get the list of all command-line parameters, execute

      java -jar toradocu-0.1-all.jar --help

Internally Toradocu executes the `javadoc` tool. Every option starting with `-J`
will be passed to the `javadoc` tool. For example, you have to specify the path
to your sources with `-J-sourcepath=...`. You can customize the behavior of the
`javadoc` tool using all its options.

Note that this is an early release of Toradocu. The tool prints a lot of
trancing/debugging information on the stadard input/error.

## Using Toradocu Aspects
Toradocu generates [AspectJ aspects](https://eclipse.org/aspectj/) in the folder
specified with the option `--outputDir`. In this folder Toradocu places the
source code of the aspects and an `aop.xml` that lists the generated aspects and
that is used by the AspectJ compiler.

To augment an existing test suite with Toradocu's oracles you have to:

1. Generate the aspects with Toradocu.
2. Compile the generated aspects.
3. Weave the existing test suites and the system under test.
4. Run the weaved test suite.

How to generate the aspects with Toradocu is described in the
[previous section](#running-toradocu).

To compile the aspects you can use `javac`. Just be sure that
[JUnit](http://junit.org/junit4/), the AspectJ weaver, and your system under
test are on the classpath.

To weave the existing test suite and the system under test, you can use the
[AspectJ compiler](https://eclipse.org/aspectj/doc/next/devguide/ajc-ref.html). 
The weaving of the system under test is needed for aspects that check the
behavior of constructors.

Run weaved test suite as a normal test suite, just be sure to have AspectJ on
the classpath.

## Notes for Developers

### Toradocu Dependencies
* `lib/tools-jdk1.8.0_72.jar`: the custom doclet depends on this jar that is
  part of the standard JDK distribution (original name: tools.jar).
  Other dependencies are listed in `build.gradle` and are automatically
  downloaded during the building process.

### Get the standard doclet source code
1. Download the source code from
   [here](http://hg.openjdk.java.net/jdk8/jdk8/langtools/tags)
   2. Standard doclet is in `/src/share/classes/com/sun/tools/doclets/`
   3. Change package declarations with the command:
      ``perl -pi -e 's/com.sun.tools.doclets/org.newpackge/g' `find . -name
      “*.java”` ``
